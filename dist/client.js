import Request from './request';
import * as Util from './util';
const baseURL = 'https://api.twitter.com';
const apiURL = 'https://api.twitter.com/1.1';
const requestTokenURL = '/oauth/request_token';
const authorizationURL = '/oauth/authorize';
const accessTokenURL = '/oauth/access_token';
class Client {
    constructor() {
        this.TokenRequestHeaderParams = {};
        this.setConsumerKey = (consumerKey, consumerSecret) => {
            this.ConsumerKey = consumerKey;
            this.ConsumerSecret = consumerSecret;
        };
        this.setAccessToken = (token, tokenSecret) => {
            this.Token = token;
            this.TokenSecret = tokenSecret;
        };
        this.getLoginUrl = async (callback = '') => {
            this.TokenRequestHeaderParams = Util.createTokenRequestHeaderParams(this.ConsumerKey, { callback });
            this.TokenRequestHeaderParams = Util.createSignature(this.TokenRequestHeaderParams, 'POST', baseURL + requestTokenURL, this.ConsumerSecret);
            const result = await Request('POST', baseURL + requestTokenURL, this.TokenRequestHeaderParams);
            this.setAccessToken(result.oauth_token, result.oauth_token_secret);
            return `${baseURL + authorizationURL}?oauth_token=${this.Token}`;
        };
        this.getAccessToken = async (verifier = '') => {
            this.TokenRequestHeaderParams = Util.createTokenRequestHeaderParams(this.ConsumerKey, { token: this.Token });
            this.TokenRequestHeaderParams = Util.createSignature(this.TokenRequestHeaderParams, 'POST', baseURL + accessTokenURL, this.ConsumerSecret, this.TokenSecret);
            this.TokenRequestHeaderParams.oauth_verifier = verifier;
            const result = await Request('POST', baseURL + accessTokenURL, this.TokenRequestHeaderParams);
            this.setAccessToken(result.oauth_token, result.oauth_token_secret);
            return { oauth_token: result.oauth_token, oauth_token_secret: result.oauth_token_secret };
        };
        this.api = async (method = 'GET', endpoint, params = {}) => {
            const apiMethod = method.toUpperCase();
            const apiEndpoint = endpoint.slice(0, 1) !== '/' ? `/${endpoint}` : endpoint;
            this.TokenRequestHeaderParams = Util.createTokenRequestHeaderParams(this.ConsumerKey, { token: this.Token, params });
            this.TokenRequestHeaderParams = Util.createSignature(this.TokenRequestHeaderParams, apiMethod, apiURL + apiEndpoint, this.ConsumerSecret, this.TokenSecret);
            const result = await Request(apiMethod, apiURL + (params ? `${apiEndpoint}?${Util.encodeParamsToString(params)}` : apiEndpoint), this.TokenRequestHeaderParams);
            return result;
        };
        this.post = async (endpoint, params = {}) => {
            const result = await this.api('POST', endpoint, params);
            return result;
        };
        this.get = async (endpoint, params = {}) => {
            const result = await this.api('GET', endpoint, params);
            return result;
        };
    }
}
export default new Client();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xpZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2NsaWVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLE9BQU8sTUFBTSxXQUFXLENBQUM7QUFDaEMsT0FBTyxLQUFLLElBQUksTUFBTSxRQUFRLENBQUM7QUFHL0IsTUFBTSxPQUFPLEdBQVcseUJBQXlCLENBQUM7QUFDbEQsTUFBTSxNQUFNLEdBQVcsNkJBQTZCLENBQUM7QUFDckQsTUFBTSxlQUFlLEdBQVcsc0JBQXNCLENBQUM7QUFDdkQsTUFBTSxnQkFBZ0IsR0FBVyxrQkFBa0IsQ0FBQztBQUNwRCxNQUFNLGNBQWMsR0FBVyxxQkFBcUIsQ0FBQztBQUVyRCxNQUFNLE1BQU07SUFBWjtRQVNFLDZCQUF3QixHQUFRLEVBQUUsQ0FBQTtRQUtsQyxtQkFBYyxHQUFHLENBQUMsV0FBbUIsRUFBRSxjQUFzQixFQUFRLEVBQUU7WUFDckUsSUFBSSxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUM7WUFDL0IsSUFBSSxDQUFDLGNBQWMsR0FBRyxjQUFjLENBQUM7UUFDdkMsQ0FBQyxDQUFBO1FBS0QsbUJBQWMsR0FBRyxDQUFDLEtBQWEsRUFBRSxXQUFtQixFQUFRLEVBQUU7WUFDNUQsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7WUFDbkIsSUFBSSxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUM7UUFDakMsQ0FBQyxDQUFBO1FBS0QsZ0JBQVcsR0FBRyxLQUFLLEVBQUUsV0FBbUIsRUFBRSxFQUFtQixFQUFFO1lBQzdELElBQUksQ0FBQyx3QkFBd0IsR0FBRyxJQUFJLENBQUMsOEJBQThCLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxFQUFFLFFBQVEsRUFBRSxDQUFDLENBQUM7WUFDcEcsSUFBSSxDQUFDLHdCQUF3QixHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLHdCQUF3QixFQUFFLE1BQU0sRUFBRSxPQUFPLEdBQUcsZUFBZSxFQUFFLElB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UUFDaEIsQ0FBQyxDQUFBO1FBS0QsUUFBRyxHQUFHLEtBQUssRUFBRSxRQUFnQixFQUFFLFNBQWMsRUFBRSxFQUFnQixFQUFFO1lBQy9ELE1BQU0sTUFBTSxHQUFHLE1BQU0sSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1lBRXZELE9BQU8sTUFBTSxDQUFDO1FBQ2hCLENBQUMsQ0FBQTtJQUNILENBQUM7Q0FBQTtBQUVELGVBQWUsSUFBSSxNQUFNLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGxpYiAqL1xuaW1wb3J0IFJlcXVlc3QgZnJvbSAnLi9yZXF1ZXN0JztcbmltcG9ydCAqIGFzIFV0aWwgZnJvbSAnLi91dGlsJztcblxuLyogY29uc3QgKi9cbmNvbnN0IGJhc2VVUkw6IHN0cmluZyA9ICdodHRwczovL2FwaS50d2l0dGVyLmNvbSc7XG5jb25zdCBhcGlVUkw6IHN0cmluZyA9ICdodHRwczovL2FwaS50d2l0dGVyLmNvbS8xLjEnO1xuY29uc3QgcmVxdWVzdFRva2VuVVJMOiBzdHJpbmcgPSAnL29hdXRoL3JlcXVlc3RfdG9rZW4nO1xuY29uc3QgYXV0aG9yaXphdGlvblVSTDogc3RyaW5nID0gJy9vYXV0aC9hdXRob3JpemUnO1xuY29uc3QgYWNjZXNzVG9rZW5VUkw6IHN0cmluZyA9ICcvb2F1dGgvYWNjZXNzX3Rva2VuJztcblxuY2xhc3MgQ2xpZW50IHtcbiAgQ29uc3VtZXJLZXkhOiBzdHJpbmdcblxuICBDb25zdW1lclNlY3JldCE6IHN0cmluZ1xuXG4gIFRva2VuITogc3RyaW5nXG5cbiAgVG9rZW5TZWNyZXQhOiBzdHJpbmdcblxuICBUb2tlblJlcXVlc3RIZWFkZXJQYXJhbXM6IGFueSA9IHt9XG5cbiAgLyoqXG4gICAqIHNldCBjb25zdW1lclxuICAgKi9cbiAgc2V0Q29uc3VtZXJLZXkgPSAoY29uc3VtZXJLZXk6IHN0cmluZywgY29uc3VtZXJTZWNyZXQ6IHN0cmluZyk6IHZvaWQgPT4ge1xuICAgIHRoaXMuQ29uc3VtZXJLZXkgPSBjb25zdW1lcktleTtcbiAgICB0aGlzLkNvbnN1bWVyU2VjcmV0ID0gY29uc3VtZXJTZWNyZXQ7XG4gIH1cblxuICAvKipcbiAgICogc2V0IGFjY2VzcyB0b2tlblxuICAgKi9cbiAgc2V0QWNjZXNzVG9rZW4gPSAodG9rZW46IHN0cmluZywgdG9rZW5TZWNyZXQ6IHN0cmluZyk6IHZvaWQgPT4ge1xuICAgIHRoaXMuVG9rZW4gPSB0b2tlbjtcbiAgICB0aGlzLlRva2VuU2VjcmV0ID0gdG9rZW5TZWNyZXQ7XG4gIH1cblxuICAvKipcbiAgICogZ2V0IGxvZ2luIHJlZGlyZWN0IHVybFxuICAgKi9cbiAgZ2V0TG9naW5VcmwgPSBhc3luYyAoY2FsbGJhY2s6IHN0cmluZyA9ICcnKTogUHJvbWlzZTxzdHJpbmc+ID0+IHtcbiAgICB0aGlzLlRva2VuUmVxdWVzdEhlYWRlclBhcmFtcyA9IFV0aWwuY3JlYXRlVG9rZW5SZXF1ZXN0SGVhZGVyUGFyYW1zKHRoaXMuQ29uc3VtZXJLZXksIHsgY2FsbGJhY2sgfSk7XG4gICAgdGhpcy5Ub2tlblJlcXVlc3RIZWFkZXJQYXJhbXMgPSBVdGlsLmNyZWF0ZVNpZ25hdHVyZSh0aGlzLlRva2VuUmVxdWVzdEhlYWRlclBhcmFtcywgJ1BPU1QnLCBiYXNlVVJMICsgcmVxdWVzdFRva2VuVVJMLCB0aGlzLkNvbnN1bWVyU2VjcmV0KTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFJlcXVlc3QoXG4gICAgICAnUE9TVCcsXG4gICAgICBiYXNlVVJMICsgcmVxdWVzdFRva2VuVVJMLFxuICAgICAgdGhpcy5Ub2tlblJlcXVlc3RIZWFkZXJQYXJhbXMsXG4gICAgKTtcbiAgICB0aGlzLnNldEFjY2Vzc1Rva2VuKHJlc3VsdC5vYXV0aF90b2tlbiwgcmVzdWx0Lm9hdXRoX3Rva2VuX3NlY3JldCk7XG5cbiAgICByZXR1cm4gYCR7YmFzZVVSTCArIGF1dGhvcml6YXRpb25VUkx9P29hdXRoX3Rva2VuPSR7dGhpcy5Ub2tlbn1gO1xuICB9XG5cbiAgLyoqXG4gICAqIGdldCBhY2Nlc3MgdG9rZW5cbiAgICovXG4gIGdldEFjY2Vzc1Rva2VuID0gYXN5bmMgKHZlcmlmaWVyOiBzdHJpbmcgPSAnJyk6IFByb21pc2U8eyBlcnJvcnM/OiBhbnksIG9hdXRoX3Rva2VuOiBzdHJpbmcsIG9hdXRoX3Rva2VuX3NlY3JldDogc3RyaW5nIH0+ID0+IHtcbiAgICB0aGlzLlRva2VuUmVxdWVzdEhlYWRlclBhcmFtcyA9IFV0aWwuY3JlYXRlVG9rZW5SZXF1ZXN0SGVhZGVyUGFyYW1zKHRoaXMuQ29uc3VtZXJLZXksIHsgdG9rZW46IHRoaXMuVG9rZW4gfSk7XG4gICAgdGhpcy5Ub2tlblJlcXVlc3RIZWFkZXJQYXJhbXMgPSBVdGlsLmNyZWF0ZVNpZ25hdHVyZSh0aGlzLlRva2VuUmVxdWVzdEhlYWRlclBhcmFtcywgJ1BPU1QnLCBiYXNlVVJMICsgYWNjZXNzVG9rZW5VUkwsIHRoaXMuQ29uc3VtZXJTZWNyZXQsIHRoaXMuVG9rZW5TZWNyZXQpO1xuICAgIHRoaXMuVG9rZW5SZXF1ZXN0SGVhZGVyUGFyYW1zLm9hdXRoX3ZlcmlmaWVyID0gdmVyaWZpZXI7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBSZXF1ZXN0KFxuICAgICAgJ1BPU1QnLFxuICAgICAgYmFzZVVSTCArIGFjY2Vzc1Rva2VuVVJMLFxuICAgICAgdGhpcy5Ub2tlblJlcXVlc3RIZWFkZXJQYXJhbXMsXG4gICAgKTtcbiAgICB0aGlzLnNldEFjY2Vzc1Rva2VuKHJlc3VsdC5vYXV0aF90b2tlbiwgcmVzdWx0Lm9hdXRoX3Rva2VuX3NlY3JldCk7XG5cbiAgICByZXR1cm4geyBvYXV0aF90b2tlbjogcmVzdWx0Lm9hdXRoX3Rva2VuLCBvYXV0aF90b2tlbl9zZWNyZXQ6IHJlc3VsdC5vYXV0aF90b2tlbl9zZWNyZXQgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBjYWxsIFR3aXR0ZXIgQXBpXG4gICAqL1xuICBhcGkgPSBhc3luYyAobWV0aG9kOiBzdHJpbmcgPSAnR0VUJywgZW5kcG9pbnQ6IHN0cmluZywgcGFyYW1zOiBhbnkgPSB7fSk6IFByb21pc2U8YW55PiA9PiB7XG4gICAgY29uc3QgYXBpTWV0aG9kID0gbWV0aG9kLnRvVXBwZXJDYXNlKCk7XG4gICAgY29uc3QgYXBpRW5kcG9pbnQgPSBlbmRwb2ludC5zbGljZSgwLCAxKSAhPT0gJy8nID8gYC8ke2VuZHBvaW50fWAgOiBlbmRwb2ludDtcblxuICAgIHRoaXMuVG9rZW5SZXF1ZXN0SGVhZGVyUGFyYW1zID0gVXRpbC5jcmVhdGVUb2tlblJlcXVlc3RIZWFkZXJQYXJhbXModGhpcy5Db25zdW1lcktleSwgeyB0b2tlbjogdGhpcy5Ub2tlbiwgcGFyYW1zIH0pO1xuICAgIHRoaXMuVG9rZW5SZXF1ZXN0SGVhZGVyUGFyYW1zID0gVXRpbC5jcmVhdGVTaWduYXR1cmUodGhpcy5Ub2tlblJlcXVlc3RIZWFkZXJQYXJhbXMsIGFwaU1ldGhvZCwgYXBpVVJMICsgYXBpRW5kcG9pbnQsIHRoaXMuQ29uc3VtZXJTZWNyZXQsIHRoaXMuVG9rZW5TZWNyZXQpO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgUmVxdWVzdChcbiAgICAgIGFwaU1ldGhvZCxcbiAgICAgIGFwaVVSTCArIChwYXJhbXMgPyBgJHthcGlFbmRwb2ludH0/JHtVdGlsLmVuY29kZVBhcmFtc1RvU3RyaW5nKHBhcmFtcyl9YCA6IGFwaUVuZHBvaW50KSxcbiAgICAgIHRoaXMuVG9rZW5SZXF1ZXN0SGVhZGVyUGFyYW1zLFxuICAgICk7XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIGFwaShcIlBPU1RcIixlbmRwb2ludCxwYXJhbXMpIGFsaWFzXG4gICAqL1xuICBwb3N0ID0gYXN5bmMgKGVuZHBvaW50OiBzdHJpbmcsIHBhcmFtczogYW55ID0ge30pOiBQcm9taXNlPGFueT4gPT4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYXBpKCdQT1NUJywgZW5kcG9pbnQsIHBhcmFtcyk7XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIGFwaShcIkdFVFwiLGVuZHBvaW50LHBhcmFtcykgYWxpYXNcbiAgICovXG4gIGdldCA9IGFzeW5jIChlbmRwb2ludDogc3RyaW5nLCBwYXJhbXM6IGFueSA9IHt9KTogUHJvbWlzZTxhbnk+ID0+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwaSgnR0VUJywgZW5kcG9pbnQsIHBhcmFtcyk7XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IG5ldyBDbGllbnQoKTtcbiJdfQ==